!function(l){function e(e){for(var r,t,a=e[0],n=e[1],o=e[2],s=0,i=[];s<a.length;s++)t=a[s],u[t]&&i.push(u[t][0]),u[t]=0;for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(l[r]=n[r]);for(m&&m(e);i.length;)i.shift()();return c.push.apply(c,o||[]),d()}function d(){for(var e,r=0;r<c.length;r++){for(var t=c[r],a=!0,n=1;n<t.length;n++){var o=t[n];0!==u[o]&&(a=!1)}a&&(c.splice(r--,1),e=s(s.s=t[0]))}return e}var t={},u={6:0},c=[];function s(e){if(t[e])return t[e].exports;var r=t[e]={i:e,l:!1,exports:{}};return l[e].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=l,s.c=t,s.d=function(e,r,t){s.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:t})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(r,e){if(1&e&&(r=s(r)),8&e)return r;if(4&e&&"object"==typeof r&&r&&r.__esModule)return r;var t=Object.create(null);if(s.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:r}),2&e&&"string"!=typeof r)for(var a in r)s.d(t,a,function(e){return r[e]}.bind(null,a));return t},s.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(r,"a",r),r},s.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},s.p="";var r=window.webpackJsonp=window.webpackJsonp||[],a=r.push.bind(r);r.push=e,r=r.slice();for(var n=0;n<r.length;n++)e(r[n]);var m=a;c.push([70,0]),d()}({70:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=t(0),n=t(5),o=t(1),s=t(6),i=t(71),l=t(7),d=t(3),u=document.getElementById("app");d.initReactAxe(u);var c="true"===u.dataset.emailUnverified,m=d.loadDomainData(u),p="My OVO"===m.site;n.render(a.createElement("div",{className:o.default({ovoBranding:p})},p?a.createElement(l.OvoHeader,null):a.createElement(s.Header,null),a.createElement(i.Login,{paymUrl:u.dataset.paymUrl+window.location.hash,domainData:m,orionUrl:u.dataset.orionUrl+window.location.hash,analytics:d.initAnalytics(u),emailUnverified:c,emailAddressQueryParam:u.dataset.emailAddress,maintenanceEnabled:u.dataset.maintenanceEnabled})),u)},71:function(e,r,t){"use strict";var a,n=this&&this.__extends||(a=function(e,r){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)},function(e,r){function t(){this.constructor=e}a(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)});Object.defineProperty(r,"__esModule",{value:!0});var o,s=t(12),i=t(1),l=t(0),d=t(4),u=t(8),c=t(11),m=t(72),p=t(73),f="username",h="password",g=(o=l.Component,n(v,o),v.prototype.checkEmailUnverified=function(){this.props.emailUnverified&&this.setState({errorMessage:"The link in your verification email is invalid or expired - please enter your email address and password to receive another one."})},v.prototype.isButtonDisabled=function(){return this.state.formSubmitting},v.prototype.getError=function(t){return(this.state.errors.filter(function(e){var r=e.id;return t===r})[0]||{error:null}).error},v.prototype.displayErrorMessage=function(){return""===this.state.errorMessage?null:l.createElement("div",{"aria-live":"assertive",role:"alert",className:"alert alert-danger text-center",id:"login-request-error"},this.state.errorMessage)},v.prototype.getFirstTimeLoginLink=function(){return"My OVO"===this.props.domainData.site?this.appendEmailIfValid("/request-access"):this.getPasswordResetLink()},v.prototype.getPasswordResetLink=function(){return this.appendEmailIfValid("/password/reset")},v.prototype.appendEmailIfValid=function(e){return null==this.validateUsername()&&0<=this.state.username.indexOf("@")?e+"?emailAddress="+encodeURIComponent(this.state.username):e},v.prototype.setError=function(e,r,t,a){this.props.analytics.trackEvent(e,"Login",""),this.props.analytics.mixpanelTrackError(r,t.data.message),0<a.length&&this.setState({errorMessage:a})},v.prototype.handle401Error=function(e){var r,t=e.data.message;"Password update required"===t?(this.setError("Password Change Required","Password Update Error",e,""),r=encodeURIComponent(this.state.username),window.location.assign("/password-expired?emailAddress="+r)):"Email verification required"===t?this.setError("Email Unverified","Email Unverified Error",e,"You need to verify your new email address. We have sent you an email with instructions on how to do this."):"Wrong email or password"===t?this.setError("Credentials Invalid","Wrong email or password Error",e,"Wrong username or password"):0<=t.indexOf("Please log in using your My")?this.setError("Account Unspecified","Multiple accounts Error",e,"Please log in using your "+this.props.domainData.accountLabel):"Please log in using your email address"===t?this.setError("Account Migrated","Migrated user Error",e,"Please log in using your email address"):"Update profile required"===t?this.handleUpdateProfileError(e):"User must contact agent"===t?this.setError("Contact Agent","Contact Agent Error",e,"It looks like your online account has been disabled. Please call us on 0330 303 5063 (Mon-Fri 8am-6pm), and weâ€™ll check why."):this.handleUnexpectedError(e)},v.prototype.handleUpdateProfileError=function(r){var t=this,e={password:this.state.password,username:this.state.username},a=document.getElementsByName("csrfToken").item(0).getAttribute("value");s.default.post("/api/identity/update-profile/request",e,{headers:{"Csrf-Token":a}}).then(function(e){var r=void 0===e.data.email||null===e.data.email?"":"&emailAddress="+encodeURIComponent(e.data.email);window.location.assign("/update-profile?token="+e.data.token+r)}).catch(function(e){401===e.response.status?t.setError("Update profile request failed","Wrong email or password Error",r,"Wrong username or password"):t.setError("Unexpected Error","Internal Server Error",r,"Internal server error")})},v.prototype.handleUnexpectedError=function(e){this.setError("Unexpected Error","Internal Server Error",e,"Internal server error")},v.prototype.handleLoginError=function(e){401===e.status?this.handle401Error(e):this.handleUnexpectedError(e)},v.prototype.componentDidMount=function(){this.props.analytics.trackPageView(d.Pages.Login),this.checkEmailUnverified()},v.prototype.handleUsernameChange=function(e){var r=e.currentTarget.value;this.setState({username:r})},v.prototype.handlePasswordChange=function(e){var r=e.currentTarget.value;this.setState({password:r})},v.prototype.render=function(){var e=this.state,r=e.errors,t=e.username,a=e.password,n="Email or "+this.props.domainData.accountLabel,o="My OVO"===this.props.domainData.site;return l.createElement("div",{className:i.default("container text-center",{ovoMargin:o})},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-sm-6 col-sm-offset-3 col-lg-4 col-lg-offset-4"},l.createElement("h1",{className:i.default("title-text h3",{"login-heading":o,"text-grey":o,"text-primary":!o})},o?"Welcome to your OVO account":"Welcome to "+this.props.domainData.site)),u.displayMaintenanceWarning(this.props.maintenanceEnabled),l.createElement("div",{className:"marginBottom"},l.createElement(m.ErrorSummary,{errors:r}))),l.createElement("div",{className:"row"},l.createElement("form",{className:"col-sm-6 col-sm-offset-3 col-lg-4 col-lg-offset-4",name:"loginForm",onSubmit:this.onLogin},this.displayErrorMessage(),l.createElement("div",{className:i.default({"styled-panel":o})},l.createElement(p.Input,{label:n,name:f,type:"text",onChange:this.handleUsernameChange,value:t,error:this.getError(f)}),l.createElement(p.Input,{label:"Password",name:h,type:"password",onChange:this.handlePasswordChange,value:a,error:this.getError(h)}),l.createElement("div",{className:"form-group"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-md-8 col-md-offset-2"},l.createElement("button",{id:"enter",type:"submit",className:"btn btn-primary btn-block submit",disabled:this.isButtonDisabled(),"automation-ref":"login-submit-button",name:"login-submit-button"},"Log in"))))),l.createElement("div",{className:"form-group text-center"},l.createElement("a",{href:this.getFirstTimeLoginLink()},"First time logging in?")),l.createElement("div",{id:"password-reset-link",className:"form-group text-center"},l.createElement("a",{href:this.getPasswordResetLink()},"Reset my password")))),l.createElement(c.Footer,{domainData:this.props.domainData}))},v);function v(e){var n=o.call(this,e)||this;n.validatePassword=function(){var e=n.state.password;return 0===e.length?"Please enter your password":e.length<5?"Password is too short":100<e.length?"Password is too long":null},n.validateUsername=function(){var e=n.state.username,r=n.props.domainData.accountLabel;return 0===e.length?"Please enter a valid email or "+r:e.length<5?"Email or "+r+" is too short":100<e.length?"Email or "+r+" is too long":null},n.onLogin=function(e){e.preventDefault(),n.setState({formSubmitting:!0});var r,t,a=[{id:f,error:n.validateUsername()},{id:h,error:n.validatePassword()}].filter(function(e){return null!=e.error});0<a.length?n.setState({errors:a,formSubmitting:!1}):(r={password:n.state.password,rememberMe:!1,username:n.state.username},t={"Did they sign in with an email address":n.state.username&&0<=n.state.username.indexOf("@"),Source:"Portal public API","Was remember me selected":!1,"What value did they sign in with":n.state.username},n.props.analytics.mixpanelTrack("Submitted Login Form",t),s.default.post("/api/v2/auth/login",r).then(function(e){n.props.analytics.trackGoal(),"IdentityPlatform"===e.data.authenticationPlatform?window.location.assign(n.props.orionUrl):window.location.assign(n.props.paymUrl)}).catch(function(e){n.setState({errors:[],formSubmitting:!1}),n.props.analytics.mixpanelIncrementError(),n.handleLoginError(e.response)}))};var r=void 0===n.props.emailAddressQueryParam?"":n.props.emailAddressQueryParam;return n.state={errorMessage:"",errors:[],formSubmitting:!1,password:"",username:r},n.handleUsernameChange=n.handleUsernameChange.bind(n),n.handlePasswordChange=n.handlePasswordChange.bind(n),n.validateUsername=n.validateUsername.bind(n),n.validatePassword=n.validatePassword.bind(n),n}r.Login=g},72:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=t(0);r.ErrorSummary=a.memo(function(e){var r=e.errors,t=a.useRef(null);return a.useEffect(function(){t.current&&t.current.focus()}),0===r.length?null:a.createElement("div",{"data-testid":"error-summary"},a.createElement("div",{className:"col-sm-6 col-sm-offset-3 col-lg-4 col-lg-offset-4 marginBottom"},a.createElement("div",{"aria-labelledby":"error-summary-title",role:"alert",tabIndex:-1,ref:t,className:"error-summary text-left"},a.createElement("h2",{id:"error-summary-title",className:"h4"},"Oops, thereâ€™s a problemâ€¦"),a.createElement("ul",null,r.map(function(e){var r=e.id,t=e.error;return a.createElement("li",{key:r},a.createElement("a",{href:"#"+r},t))})))))})},73:function(e,r,t){"use strict";var a,n=this&&this.__extends||(a=function(e,r){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])})(e,r)},function(e,r){function t(){this.constructor=e}a(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)});Object.defineProperty(r,"__esModule",{value:!0});var o,i=t(0),s=(o=i.Component,n(l,o),l.prototype.errorId=function(){return this.props.name+"-error"},l.prototype.errorMessage=function(){var e=this.props.error;return null==e?null:i.createElement("div",{className:"alert alert-danger text-left",id:this.errorId()},i.createElement("div",null,e))},l.prototype.render=function(){var e=this.props,r=e.onChange,t=e.value,a=e.type,n=e.name,o=e.label,s=e.error;return i.createElement("div",{className:"form-group "+n+" text-left "+(null==s?"":"has-error"),id:n+"-wrapper"},i.createElement("label",{htmlFor:n},o),i.createElement("input",{type:a,className:"form-control",id:n,name:n,"aria-invalid":null==s?void 0:"true","aria-describedby":null==s?void 0:this.errorId(),value:t,onChange:r,"automation-ref":"login-"+n+"-input"}),this.errorMessage())},l);function l(){return null!==o&&o.apply(this,arguments)||this}r.Input=s}});